generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model jenis_kendaraan {
  id          Int      @id @default(autoincrement())
  nama        String   @db.VarChar(255)
  jumlah_seat Int
  created_at  DateTime @default(now()) @db.Timestamp(0)
  produk      produk[]
}

model paket_wisata {
  id                         Int                          @id @default(autoincrement())
  nama                       String                       @db.VarChar(255)
  deskripsi                  String                       @db.Text
  fasilitas                  String                       @db.Text
  foto                       Json                       
  jam_keberangkatan          DateTime                     @db.Time(0)
  lama_perjalanan            Int
  created_at                 DateTime                     @default(now()) @db.Timestamp(0)
  paket_wisata_tempat_wisata paket_wisata_tempat_wisata[]
  produk                     produk[]
}

model paket_wisata_tempat_wisata {
  id               Int           @id @default(autoincrement())
  paket_wisata_id  Int
  tempat_wisata_id Int
  paket_wisata     paket_wisata  @relation(fields: [paket_wisata_id], references: [id], onUpdate: Restrict, map: "paket_wisata_tempat_wisata_ibfk_1")
  tempat_wisata    tempat_wisata @relation(fields: [tempat_wisata_id], references: [id], onUpdate: Restrict, map: "paket_wisata_tempat_wisata_ibfk_2")

  @@index([paket_wisata_id], map: "paket_wisata_id")
  @@index([tempat_wisata_id], map: "tempat_wisata_id")
}

model pemesanan {
  id                    Int               @id @default(autoincrement())
  kode_pemesanan        String            @db.VarChar(25)
  user_id               Int?
  produk_id             Int
  promo_id              Int?
  total_bayar           Float?
  status                pemesanan_status?
  batas_bayar           DateTime?         @db.DateTime(0)
  tanggal_bayar         DateTime?         @db.DateTime(0)
  metode_bayar          String?           @db.VarChar(255)
  payment_url           String?           @db.Text
  tanggal_keberangkatan DateTime          @db.Date
  lokasi_jemput_lat     String?           @db.VarChar(255)
  lokasi_jemput_lng     String?           @db.VarChar(255)
  created_at            DateTime          @default(now()) @db.Timestamp(0)
}

model produk {
  id                 Int              @id @default(autoincrement())
  nama               String           @db.VarChar(255)
  harga              Float?
  jenis_kendaraan_id Int?
  paket_wisata_id    Int?
  created_at         DateTime         @default(now()) @db.Timestamp(0)
  jenis_kendaraan    jenis_kendaraan? @relation(fields: [jenis_kendaraan_id], references: [id], onDelete: Restrict, onUpdate: Restrict, map: "produk_ibfk_1")
  paket_wisata       paket_wisata?    @relation(fields: [paket_wisata_id], references: [id], onDelete: Restrict, onUpdate: Restrict, map: "produk_ibfk_2")

  @@index([jenis_kendaraan_id], map: "jenis_kendaraan_id")
  @@index([paket_wisata_id], map: "paket_wisata_id")
}

model promo {
  id            Int      @id @default(autoincrement())
  nama          String   @db.VarChar(255)
  kode          String   @db.VarChar(15)
  persen        Int
  min_pembelian Float?
  max_potongan  Float?
  tanggal_mulai DateTime @db.Date
  tanggal_akhir DateTime @db.Date
  created_at    DateTime @default(now()) @db.Timestamp(0)
}

model tempat_wisata {
  id                         Int                          @id @default(autoincrement())
  nama                       String                       @db.VarChar(255)
  deskripsi                  String                       @db.Text
  foto                       Json                       
  latitude                   String                       @db.VarChar(255)
  longitude                  String                       @db.VarChar(255)
  kota                       String                       @db.VarChar(255)
  provinsi                   String                       @db.VarChar(255)
  created_at                 DateTime                     @default(now()) @db.Timestamp(0)
  paket_wisata_tempat_wisata paket_wisata_tempat_wisata[]
}

model users {
  id              Int        @id @default(autoincrement())
  nama            String     @db.VarChar(255)
  email           String     @unique(map: "email") @db.VarChar(255)
  no_telp         String     @db.VarChar(16)
  profile_picture String?    @db.Text
  role            users_role
  password        String     @default("") @db.VarChar(255)
  created_at      DateTime   @default(now()) @db.Timestamp(0)
}

enum pemesanan_status {
  DIPROSES
  PENDING
  SELESAI
  DIBATALKAN
}

enum users_role {
  CUSTOMER
  ADMIN
  SOPIR
}
